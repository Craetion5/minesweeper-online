<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: mapGenerator.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: mapGenerator.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>let map = [];
let clientMap = [];
let mapHeight = null;
let mapWidth = null;

/**
 * Creates a map with given height, width and mines percentage.
 * @param {int} height 
 * @param {int} width 
 * @param {int} minesPercentage 
 * @returns Object with fields fullMap, clientMap
 */
function createMap(height, width, minesPercentage) {
  map = []
  clientMap = []
  mapHeight = height;
  mapWidth = width;
  for (let y = 0; y &lt; height; y++) {
    var row = [];
    var row1 = [];
    for (let x = 0; x &lt; width; x++) {
      row[x] = 0;
      row1[x] = 9;
    }
    map[y] = row;
    clientMap[y] = row1;
  }
  placeMines(height, width, minesPercentage);
  return { fullMap: map, clientMap };
}

function inBounds(x, y) {
  return x >= 0 &amp;&amp; x &lt; mapWidth &amp;&amp; y >= 0 &amp;&amp; y &lt; mapHeight;
}

/**
 * Calculates percentage of mines in map
 * @param {array} fullMap 
 * @returns number, percentage of mines
 */
function calculateMinesPercentage(fullMap) {
  var amountOfMines = 0;
  for (let i = 0; i &lt; fullMap[0].length; i++) {
    for (let j = 0; j &lt; fullMap.length; j++) {
      if (fullMap[j][i] == 11) {
        amountOfMines++;
      }
    }
  }
  return amountOfMines / (fullMap.length * fullMap[0].length) * 100;
}

/**
 * Places mines on global map array
 * @param {int} height Size of map in tiles
 * @param {int} width 
 * @param {int} minesPercentage Percentage of mines from map tiles
*/
function placeMines(height, width, minesPercentage) {
  var amountOfMines = height * width * minesPercentage / 100;

  for (let index = 0; index &lt; amountOfMines; index++) {
    mineX = Math.floor(Math.random() * width);
    mineY = Math.floor(Math.random() * height);
    if (map[mineY][mineX] === 11) {
      index--;
      continue;
    }
    map[mineY][mineX] = 11;

    for (let dx = -1; dx &lt;= 1; dx += 1) {
      for (let dy = -1; dy &lt;= 1; dy += 1) {
        if (dx === dy === 0) {
          continue;
        }
        let x = mineX + dx;
        let y = mineY + dy;
        if (!inBounds(x, y)) {
          continue;
        }
        if (map[y][x] &lt; 8 &amp;&amp; map[y][x] >= 0) {
          map[y][x] += 1;
        }
      }
    }
  }
}
module.exports = { createMap, calculateMinesPercentage };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#allOpened">allOpened</a></li><li><a href="global.html#calculateMinesPercentage">calculateMinesPercentage</a></li><li><a href="global.html#createMap">createMap</a></li><li><a href="global.html#freshGame">freshGame</a></li><li><a href="global.html#openAdjacentTiles">openAdjacentTiles</a></li><li><a href="global.html#placeMines">placeMines</a></li><li><a href="global.html#runGameLogic">runGameLogic</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Mon Nov 14 2022 19:54:13 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
